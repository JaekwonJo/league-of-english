# ADR Addendum 2025-09-19

42) Manual-Guided API Problem Generation
- Problem: AI가 생성하는 빈칸/주제/제목 등 문제가 지문과 동떨어진 선택지를 내거나 한글로 출력되는 등 품질이 일정하지 않았다.
- Decision: 각 유형별 매뉴얼(`problem manual/*.md`)을 프롬프트에 주입하고, JSON 스키마를 강제해 `source`, `mainText`, `options`, `explanation`을 완비하도록 표준화했다. API 실패 시에도 동일한 구조를 따르는 규칙 기반 폴백을 제공한다.
- Impact: 모든 유형이 지문-선택지-근거를 포함한 수능형 MCQ를 안정적으로 출력하며, 메타데이터(`documentTitle`, `passageNumber`)가 누락되지 않는다.

43) 문제 카드 UI/UX 통일
- Problem: 순서배열/문장삽입을 제외한 유형은 흰 배경과 단순 버튼을 사용해 가독성이 떨어지고, 출처-지문-문제 순서도 일관되지 않았다.
- Decision: `ProblemDisplay`를 개편해 모든 유형이 같은 다크 테마 카드, 출처 박스, 원문 박스, 지시문 레이아웃을 사용하도록 통일했다. 밑줄 강조도 `<u>` 파서를 공유한다.
- Impact: 사용자는 모든 유형에서 동일한 정보 구조(출처 → 영어 원문 → 문제 지시문 → 선택지)를 따르게 되어 학습 흐름이 자연스럽고 시각적 피로가 줄어든다.

44) 문법 규칙 기반 생성 고도화
- Problem: 기존 `grammarSpanGenerator`는 무작위로 단어를 밑줄만 그려 실제 문법 오류가 존재하지 않는 문제가 다수였다.
- Decision: 주어-동사 수일치, 관사, 대명사 혼동을 자동으로 주입하는 규칙 기반 변환을 추가하고, ①~⑤ 라벨과 스니펫을 생성하도록 개선했다.
- Impact: 규칙 출제 모드에서도 수능 29번형 밑줄 문법 문제가 즉시 활용 가능하며, 설명이 명확한 한 개의 오답만 포함된다.
