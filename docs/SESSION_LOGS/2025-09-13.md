# 2025-09-13 Session Log

Scope
- Enforce API-only generation for CSAT MCQ types and upgrade result/analysis UX.

Changes
- API-only policy: title/theme(summary:topic)/summary/blank/vocabulary/irrelevant/implicit now require OpenAI; local fallbacks removed. Insufficient AI items ??503 with clear message.
- Client Study/Worksheet: switched to POST /api/generate/csat-set (no smart-problems fallback). Shows retry on 503.
- Result UX: badges (?éØ/?íé/???èÖ), confetti, points count-up, rank-up overlay, tier progress; Korean labels restored.
- Tier visuals: iron?íchallenger gradient; diamond/master/challenger have luxurious glow/pulse.
- Analysis page: section emojis and emphasis (underline/italic/highlight tags); vocabulary chips for synonyms/antonyms.
- PROMPTS: aiProblemService2 reads root PROBLEM_PROMPTS_*.md and docs/SPECS; specs govern JSON-only, 5-choice, evidence.

Notes
- Verified with LOE 9??Î¨∏ÏÑú(ID 5): 9Î¨∏Ìï≠ ?∏Ìä∏ ?ùÏÑ±, explanations/evidence surfaced in UI.
- Residual mojibake remains in a few static texts; queued for cleanup.


Addendum ? Stability & KR UI (later same day)
- Fixed 404 on POST /api/generate/csat-set by ensuring router export occurs after route definitions; endpoint validated 200 OK.
  - server/routes/problem.routes.js: ensured module.exports at bottom; validated via manual POST.
- Fixed server crash in vocab routes: replaced missing requireRole with available requireAdmin middleware.
  - server/routes/vocab.routes.js: updated to use requireAdmin on upload/list endpoints.
- Resolved port conflicts (EADDRINUSE 5000, something on 3000): killed PIDs on 3000/5000; documented client:alt.
- Korean UI cleanup pass (mojibake °Ê proper KR):
  - client/src/pages/AdminPage.js: header/buttons/categories/defaults; prompts standardized.
  - client/src/components/admin/UploadModal.js: labels/placeholders/buttons.
  - client/src/components/admin/CategoryModal.js: title/labels/buttons.
  - client/src/components/admin/EditModal.js: title/labels/buttons.
  - client/src/components/admin/DocumentList.js: loading/empty-state/tooltips.
  - client/src/pages/StudyPage.js: loading/error/CTA texts; friendly mapping for 404/503/401.
- Ran encoding cleaner: npm run encoding:apply-basic °Ê Scanned 148 files; Issues 126; Modified 2 (server/scripts/encoding-cleanup.js, client/src/components/study/StudyResult.js).
- Launched dev processes in new windows to avoid terminal lock; documented client:alt (PORT=3001) fallback.

Next Focus (stability)
- Add pre-commit hook to block mojibake regressions.
- Begin i18n centralization for UI strings.
- Evidence UX: inline evidenceLines toggle and highlight.


## Addendum ? 2025-09-13 (Stability & KR UI)
- Fixed /api/generate/csat-set 404 by ensuring route export order; verified 200 OK
- Vocab admin endpoints guarded with requireAdmin
- Pre-commit encoding scan added to block mojibake commits
- i18n resource + helper added; Admin/Study core screens updated
- Evidence UX minimal implemented (results: evidenceLines + highlight toggle)
- Windows console guide + ASCII log option (LOE_ASCII_LOG=1)
