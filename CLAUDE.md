
# 📄 CLAUDE.md 

## 💡 프로젝트 한 줄 소개

**League of English** = “**원문 문서 → 수능형 영어 문제를 무한 생성**”하는 웹앱.
학생은 게임처럼 풀고(타이머/점수/랭크), 선생님은 문서 업로드로 바로 과제/시험 생성!

---

## 🧱 기술 & 폴더 구조(최소)
## ⚙️ 설치 & 실행 (복붙만)

**테스트 계정**

* 관리자: `admin / admin123`

---

## 🔑 핵심 기능 흐름 (초간단)

1. **문서 업로드(관리자/교사)** → PDF/TXT에서 **영어만 추출** → DB 저장
2. **문제 생성(학생)** → 문서 선택 → **규칙형(순서배열/문장삽입)** + **AI형(빈칸/어법/어휘/제목/주제)**
3. **풀이/채점/해설** → **통계/랭크** 반영 → 취약 유형 다시 연습
4. **단어장 업로드(관리자/교사)** → PDF/TXT에서 **영어만 추출** → DB 저장
5. **단어 시험생성(학생)** → 단어장 선택 → **(뜻만/동의어찾기/반의어찾기)** 

**스마트한 포인트**

* 🧠 **중복 방지**: 최근 푼 문제 제외
* 💾 **캐싱**: 유형당 100문제 넘으면 **재사용**(비용↓), 다 풀면 다시 생성
* ⏱️ **타이머**: 기본 2분/문항, 고급 1분/문항
* 🎚️ 난이도: 기본/고급(예: 순서배열 A~~C ▶ A~~E)

---

## 🧭 문제 유형(8대 유형 요약)

* **규칙 기반(비용 0)**: **문장 삽입, 순서 배열**
* **AI 기반**: **빈칸, 어법, 어휘, 제목, 주제, 요약/무관”

> 문두는 한국어 고정(“다음 글의 ~~”), 보기 \*\*①~~⑤\*\*, **정답+해설** 포함

---

## 🔌 API (최소 요약)


---

## 🧩 데이터(간단 개념)

* **users**: 학생/교사/관리자, 멤버십/포인트/티어
* **documents**: 업로드 텍스트(영어만), 출처/카테고리
* **problems**: 생성된 문제(유형/정답/해설/난이도)
* **study\_records**: 채점 기록(정오/시간/유저)

---

## 🎮 게이미피케이션(요약)

* **LP**(점수)로 **티어** 상승: Iron → Bronze → … → Challenger
* 정답/연속정답/첫학습 보너스, 오답/포기 페널티
티어 시스템
- Iron (0-999 LP): 기본
- Bronze (100-1999 LP): 프로필 뱃지
- Silver (2000-2999 LP): 실버 테두리
- Gold (3000-4999 LP): 골드 테두리
- Platinum (5000-9999 LP): 플레티넘 테두리, 플레티넘 이펙트
- Diamond (10000-29999 LP): 다이아몬드 테두리, 다이아몬드 이펙트
- Master (30000-99999 LP): 마스터 테두리, 마스터 이펙트
- Challenger (100000+ LP): 챌린저 특별 테두리, 챌린저 특별 이펙트

LP 시스템
획득:
- 정답: +10 LP (기본)
- 연속 정답: +15 LP
- 일일 첫 학습: +30 LP
- 주간 목표: +100 LP

차감:
- 오답: -5 LP
- 시간초과: -3 LP
- 포기: -10 LP

---

## 💰 가격(3단계 전략 · 초간단)

* **베이직 9,900원**: 월 1,000문제, 채점만
* **플러스 14,900원**: 무제한 + **해설**
* **프로 19,900원**: 플러스 + **상세 통계/추천**

> 👉 낮은 진입가 → 자연스런 업그레이드 → 수익 안정화

---

## 🧱 “AI 코딩 요청서” (매번 복붙하세요!)

> 이걸 **다음 AI에게 그대로 붙여넣기**하면, **거대한 단일파일 방지**됩니다.

* 아키텍처: **모듈러 모놀리식** (`routes/`, `services/`, `middlewares/`, `models/`, `config/`, `utils/`)
* 파일 규칙: **한 파일 500줄 초과 금지**
* 설정: 상수/규칙/매직넘버 → **`config/*.json` / `.env`** (하드코딩 금지)
* 전략패턴: 문제유형 \*\*맵(레지스트리)\*\*로 연결( **if/else 체인 금지** )
* 에러 처리: **모든 라우트 try/catch + next(err)**, 전역 에러 핸들러
* 로깅: 필수 설정 출력, **짧은 단계 로그**
* 테스트: **요청/응답 예시** 1\~2개 포함
  **체크리스트**
  \[ ] 파일 분할 OK(500줄↑ 없음) / \[ ] config/.env 사용 / \[ ] 유형 레지스트리 / \[ ] 에러 핸들러

---

## 🧰 자주 터지는 문제(빠른 해결)

* “문제 불러오기 실패”: **OPENAI\_API\_KEY** 확인, **documentId** 전달 여부, **서버 로그**
* `undefined`/상태 에러: state/핸들러 **정의** 누락 확인
* 업로드 실패: **PDF/TXT, 10MB** 제한 확인

---

## 🗺️ 로드맵(요약)

* **P1(MVP)**: 로그인/업로드/기초 통계/규칙형 생성
* **P2**: AI 문제 생성/단어시험/결제/관리자 대시보드
* **P3**: 고급 통계/추천/소셜/모바일/PWA

---

## 🎨 디자인 톤(짧게)

* 다크 아카데미아 × e스포츠, 글래스모피즘 카드, 네온 액센트
* 정답 ✅ **초록 반짝임**, 오답 ❌ **빨강 흔들림**, 레벨업 이펙트 ✨

---

## 🆘 응급 복구 명령어

```bash
# DB 초기화
cd server && del database.db && node server.js

# 캐시 클리어
npm cache clean --force

# 의존성 재설치
rd /s /q node_modules && npm install
```

---

## ✅ 오늘의 핵심 요약(진짜 핵심 3줄)

1. **문서 업로드 → 영어만 추출 → 문제 자동 생성(규칙+AI)**
2. **중복 방지·캐싱·타이머·랭크**로 “게임처럼” 학습
3. **AI에게는 항상 ‘모듈 분할·JSON 설정·전략패턴·체크리스트’ 요구!**

---
