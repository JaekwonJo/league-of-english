# PROJECT_STATE.md

## 2025-11-22 업데이트 (기출 AI 파서 + 문제 품질 완벽화 + 크리스마스 테마)
- **기출문제 혁신**: 기존 Regex 파서의 한계를 넘어 `gpt-4o-mini`를 도입, 뒤죽박죽 섞인 2단 편집 텍스트도 문맥 기반으로 완벽하게 복구·구조화하는 "AI 파서"를 완성했습니다. 텍스트 직접 입력 및 멀티 파일 업로드 기능으로 편의성을 극대화했습니다.
- **문제 품질 안정화**: 어휘(반의어 강제), 빈칸(해설 번호 자동 교정), 요약(정답 논리 보장) 등 모든 AI 문제 유형의 고질적인 오류를 근본적으로 해결했습니다.
- **디자인 리뉴얼**: 홈 화면에 3D 크리스마스 트리와 구글 Gemini 스타일의 3x3 유리 카드(Glassmorphism) UI를 적용해 시각적 완성도를 높였습니다.

### Current Stage
- **완성 단계**: 기출문제 업로드/파싱 안정화 + AI 문제 생성 품질 검증 완료. 이제 콘텐츠 확장만 남았습니다.

### Next 3
1) **재출제 다양성 모니터링**: AI 생성 시 시드(Seed) 다양화를 통해 같은 문제가 반복되지 않는지 확인.
2) **모바일 UI 미세 조정**: 새로운 3x3 그리드 메뉴가 모든 기기에서 완벽하게 보이도록 튜닝.
3) **PDF 파서 비용 최적화**: `gpt-4o-mini` 파싱 비용 모니터링 및 최적화 (현재도 매우 저렴함).

## Resolved (오늘)
- **기출문제 AI 파서**: `import-exam-pdf.js`를 `gpt-4o-mini` 기반으로 전면 교체. 2단 편집/인코딩 깨짐 문제 영구 해결.
- **관리자 편의성**: 기출문제 텍스트 직접 입력 모드 추가, PDF 파일 멀티 드래그 업로드 및 순차 처리 구현.
- **어휘 문제 Fix**: 정답 보기가 원문과 같으면 생성을 거부하고 재시도하여, 반드시 반의어(Contextual Antonym)가 출제되도록 강제.
- **빈칸 문제 Fix**: 보기를 섞을 때 해설지(`explanation`) 내의 번호(예: ③)가 실제 정답 번호로 자동 치환되도록 로직 구현.
- **요약 문제 Fix**: AI가 정답을 항상 0번 인덱스에 생성하게 하고, 서버에서 셔플하여 논리적 정답 오류 원천 차단.
- **UI/UX**: 홈 화면 크리스마스 테마(3D 트리, 눈 효과) 및 Gemini 스타일 3x3 메뉴 적용. 학습 헤더 위치 상단 이동, 다시 풀기 로직 개선, 어법 줄바꿈(`pre-wrap`) 적용.
- **서버**: CORS 화이트리스트에 도메인 추가, 아이디 찾기 등 자잘한 기능 보강.

## 우리가 만드는 것
- PDF나 텍스트 지문을 업로드하면 **수능 스타일 문제·해설·분석**을 자동으로 만들어 주는 학습 플랫폼.
- 학생은 웹에서 문제를 풀고 채점·해설·랭킹·신고 기능을 이용할 수 있어요.
- 선생님(관리자)은 분석본을 검수하고, 마음에 들지 않는 변형을 삭제하거나 신고를 처리할 수 있어요.

## 기술 스택 & 핵심 명령어
- **백엔드**: Node.js 20 + Express, SQLite(sql.js) / OpenAI API (gpt-4o-mini, gpt-4o)
- **프런트엔드**: React 19 (CRA), Zustand + SWR
- **공통 명령**
  - 개발: `npm run dev:all` (백엔드 5000, 프런트 3000)
  - 테스트: `npm test`
  - 프런트 빌드: `npm run build`
  - 린트: `npm run lint`